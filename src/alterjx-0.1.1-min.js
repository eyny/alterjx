class AlterJX{constructor(t=2){this._indentSize=t}get indentSize(){return this._indentSize}set indentSize(t){this._indentSize=t}toJSON(t){switch(this._checkDataType(t)){case this._dataType.JSON:return t;case this._dataType.JS:return this._JStoJSON(t);case this._dataType.DOM:return this._JStoJSON(this._DOMtoJS(t));case this._dataType.XML:return this._JStoJSON(this._DOMtoJS(this._XMLtoDOM(t)));case this._dataType.UNKNOWN:throw this._unknownTypeError}}toJS(t){switch(this._checkDataType(t)){case this._dataType.JSON:return this._JSONtoJS(t);case this._dataType.JS:return t;case this._dataType.DOM:return this._DOMtoJS(t);case this._dataType.XML:return this._DOMtoJS(this._XMLtoDOM(t));case this._dataType.UNKNOWN:throw this._unknownTypeError}}toDOM(t){switch(this._checkDataType(t)){case this._dataType.JSON:return this._JStoDOM(this._JSONtoJS(t));case this._dataType.JS:return this._JStoDOM(t);case this._dataType.DOM:return this.src;case this._dataType.XML:return this._XMLtoDOM(t);case this._dataType.UNKNOWN:throw this._unknownTypeError}}toXML(t){switch(this._checkDataType(t)){case this._dataType.JSON:return this._DOMtoXML(this._JStoDOM(this._JSONtoJS(t)));case this._dataType.JS:return this._DOMtoXML(this._JStoDOM(t));case this._dataType.DOM:return this._DOMtoXML(t);case this._dataType.XML:return t;case this._dataType.UNKNOWN:throw this._unknownTypeError}}get _dataType(){return{UNKNOWN:-1,JSON:0,JS:1,DOM:2,XML:3}}get _unknownTypeError(){return"Error: unknown data type"}_checkDataType(t){return"string"==typeof t?"{"===t.charAt(0)?this._dataType.JSON:"<"===t.charAt(0)?this._dataType.XML:this._dataType.UNKNOWN:t.nodeType>1?this._dataType.XML:"object"==typeof t?this._dataType.JS:this._dataType.UNKNOWN}_beautifyXML(t){let e=this.indentSize;if(e<=0)return t;{let r="",a="";return t.split(/>\s*</).forEach(function(t){t.match(/^\/\w/)&&(a=a.slice(e)),r+=a+"<"+t+">\r\n",t.match(/^<?\w[^>]*[^\/]$/)&&(a+=" ".repeat(e))}),r.slice(1,r.length-3)}}_JSONtoJS(t){return JSON.parse(t)}_JStoDOM(t,e=null){if(null===e){let e=Object.keys(t)[0];return this._JStoDOM(t[e],e)}if(Array.isArray(t)){let r=document.createDocumentFragment();for(let a of t)r.appendChild(this._JStoDOM(a,e));return r}if("#text"===e)return document.createTextNode(t);let r=document.createElement(e);return t!==Object(t)?(r.appendChild(document.createTextNode(t)),r):(Object.keys(t).map(e=>{let a=t[e];"@"==e.charAt(0)?r.setAttribute(e.substring(1),a):r.appendChild(this._JStoDOM(a,e))}),r)}_DOMtoXML(t){let e=(new XMLSerializer).serializeToString(t);return e=e.replace(' xmlns="http://www.w3.org/1999/xhtml"',""),e=this._beautifyXML(e)}_XMLtoDOM(t){return(new DOMParser).parseFromString(t,"text/xml")}_DOMtoJS(t){let e=[...t.children],r={};if(1===t.nodeType&&t.hasAttributes())for(let e of t.attributes)r["@"+e.name]=e.value;if(0===e.length)return t.hasAttributes()?(0!==t.innerHTML.length&&(r["#text"]=t.innerHTML),r):t.innerHTML;for(let t of e){e.filter(e=>e.nodeName===t.nodeName).length>1?void 0===r[t.nodeName]?r[t.nodeName]=[this._DOMtoJS(t)]:r[t.nodeName].push(this._DOMtoJS(t)):r[t.nodeName]=this._DOMtoJS(t)}return r}_JStoJSON(t){return JSON.stringify(t,null,this.indentSize)}}